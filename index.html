<!DOCTYPE html>
<html>
<head>
    <title>TouchIn</title>
    <!-- <link href="https://s3.amazonaws.com/Togethr.io/bootstrap.min.css" rel="stylesheet" media="screen"> -->
</head>

<body>
     <input id="testbtn" type = "button"> Get reviews</button>
     <!-- hello -->
 </body>


<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js">
</script>

<script>
// alert('hello');
$(function() {
    // VUFSbua5RgR7Ers7wrivV0MklE48sP
    // var getRating = function() {
    //     $.ajax({
    //         type: 'GET',
    //         url: 'http://api.penncoursereview.com/v1/coursehistories/'+'cis-120'+'?token=public',
    //         // data: {query: },
    //         dataType: 'json'
    //     }).done(function(data) {
    //         return data['result']['courses'][1]['name'];
    //     });
    // };

    // $('#hi').load("http://penncoursereview.com/course/CIS-120 #div.grid_1 scorebox > p" );
    var fn = function() {
        alert('hello');
    };

    $('#testbtn').click(function() {

        $.ajax({
            type: 'GET',
            url: 'http://api.penncoursereview.com/v1/depts/cis/reviews?token=VUFSbua5RgR7Ers7wrivV0MklE48sP',
            // data: {query: },
            dataType: 'json'
        }).done(function(data) {
            console.log(data);
            var cl = "CIS-320";
            var inst = "rajiv c. gandhi";
            inst = inst.replace(/\./g, '');
            var classes = data.result.values;
            var qualityavg = 0;
            var difficultyavg = 0;
            var numcourses = 0;

            var prof_lookup = 0;
            var numprofcourses = 0;

            classes.forEach(function(name) {
                var alias = name.section.primary_alias.trim().slice(0,-4);
                alias = alias.replace(/\s/g,''); 
                // console.log(alias);
                var instructor = name.instructor.name.toLowerCase();
                instructor = instructor.replace(/\./g, '');
                // console.log(instructor);
                // console.log(inst);

                if (instructor === inst) {

                    prof_lookup += parseFloat(name.ratings.rInstructorQuality);
                    // console.log(name);
                    numprofcourses++;
                }
                if (cl == alias) {
                    qualityavg+=parseFloat(name.ratings.rCourseQuality);
                    difficultyavg+=parseFloat(name.ratings.rDifficulty);
                    numcourses++;
                }

            });
            qualityavg =qualityavg/numcourses;
            difficultyavg= difficultyavg/numcourses;
            prof_lookup = prof_lookup/numprofcourses;
            // console.log(qualityavg);
            // console.log(difficultyavg);
            console.log(prof_lookup);
        });
    });
});


</script>